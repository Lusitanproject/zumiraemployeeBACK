"use client";

import { useState } from "react";

import { ChatUi } from "@/components/ui/act-chat/chat-ui";
import { cn } from "@/lib/utils";
import { ActChapter } from "@/types/acts";

import { Book } from "./book";

interface WhiteboardProps {
  actChapter: ActChapter;
}

export function Whiteboard({ actChapter }: WhiteboardProps) {
  const [bookState, setBookState] = useState<"closed" | "open" | "expanded">("closed");

  return (
    <div className="absolute flex flex-row size-full left-0 top-0">
      <div className={cn("flex h-full duration-500", bookState === "expanded" ? "w-0" : "w-full")}>
        <ChatUi actChapter={actChapter} />
      </div>
      <Book
        actChapter={actChapter}
        state={bookState}
        onExpand={() => setBookState((prev) => (prev === "open" ? "expanded" : "open"))}
      />
      <button
        className={cn("absolute flex right-0 top-1/2 -translate-y-1/2 cursor-pointer duration-100")}
        onClick={() => setBookState("open")}
      >
        <svg fill="none" height="184" viewBox="0 0 38 184" width="38" xmlns="http://www.w3.org/2000/svg">
          <path d="M0 33C0 28.5817 3.58172 25 8 25H38V158H8C3.58172 158 0 154.418 0 150V33Z" fill="#5ABB8D" />
          <path
            d="M25 135.024L20.552 137.584L20.552 138.976L25 138.976L25 140.8L13.88 140.8L13.88 136.96C13.88 136.107 14.0293 135.387 14.328 134.8C14.6267 134.203 15.0267 133.76 15.528 133.472C16.0293 133.173 16.5893 133.024 17.208 133.024C17.9333 133.024 18.5947 133.237 19.192 133.664C19.7787 134.08 20.1787 134.725 20.392 135.6L25 132.848L25 135.024ZM19.096 138.976L19.096 136.96C19.096 136.277 18.9253 135.765 18.584 135.424C18.2427 135.072 17.784 134.896 17.208 134.896C16.632 134.896 16.184 135.067 15.864 135.408C15.5333 135.749 15.368 136.267 15.368 136.96L15.368 138.976L19.096 138.976ZM20.376 121.861C20.7067 121.861 21.0053 121.882 21.272 121.925L21.272 128.661C21.976 128.607 22.5413 128.346 22.968 127.877C23.3947 127.407 23.608 126.831 23.608 126.149C23.608 125.167 23.1973 124.474 22.376 124.069L22.376 122.101C23.1867 122.367 23.8533 122.853 24.376 123.557C24.888 124.25 25.144 125.114 25.144 126.149C25.144 126.991 24.9573 127.749 24.584 128.421C24.2 129.082 23.6667 129.605 22.984 129.989C22.2907 130.362 21.4907 130.549 20.584 130.549C19.6773 130.549 18.8827 130.367 18.2 130.005C17.5067 129.631 16.9733 129.114 16.6 128.453C16.2267 127.781 16.04 127.013 16.04 126.149C16.04 125.317 16.2213 124.575 16.584 123.925C16.9467 123.274 17.4587 122.767 18.12 122.405C18.7707 122.042 19.5227 121.861 20.376 121.861ZM19.8 123.765C19.128 123.775 18.5893 124.015 18.184 124.485C17.7787 124.954 17.576 125.535 17.576 126.229C17.576 126.858 17.7787 127.397 18.184 127.845C18.5787 128.293 19.1173 128.559 19.8 128.645L19.8 123.765ZM20.584 119.924C19.6773 119.924 18.8827 119.742 18.2 119.38C17.5067 119.006 16.9733 118.494 16.6 117.844C16.2267 117.193 16.04 116.446 16.04 115.604C16.04 114.537 16.296 113.657 16.808 112.964C17.3093 112.26 18.0293 111.785 18.968 111.54L18.968 113.508C18.5307 113.668 18.1893 113.924 17.944 114.276C17.6987 114.628 17.576 115.07 17.576 115.604C17.576 116.35 17.8427 116.948 18.376 117.396C18.8987 117.833 19.6347 118.052 20.584 118.052C21.5333 118.052 22.2747 117.833 22.808 117.396C23.3413 116.948 23.608 116.35 23.608 115.604C23.608 114.548 23.144 113.849 22.216 113.508L22.216 111.54C23.112 111.796 23.8267 112.276 24.36 112.98C24.8827 113.684 25.144 114.558 25.144 115.604C25.144 116.446 24.9573 117.193 24.584 117.844C24.2 118.494 23.6667 119.006 22.984 119.38C22.2907 119.742 21.4907 119.924 20.584 119.924ZM25.144 105.148C25.144 105.98 24.9573 106.732 24.584 107.404C24.2 108.076 23.6667 108.604 22.984 108.988C22.2907 109.372 21.4907 109.564 20.584 109.564C19.688 109.564 18.8933 109.367 18.2 108.972C17.5067 108.577 16.9733 108.039 16.6 107.356C16.2267 106.673 16.04 105.911 16.04 105.068C16.04 104.225 16.2267 103.463 16.6 102.78C16.9733 102.097 17.5067 101.559 18.2 101.164C18.8933 100.769 19.688 100.572 20.584 100.572C21.48 100.572 22.2747 100.775 22.968 101.18C23.6613 101.585 24.2 102.14 24.584 102.844C24.9573 103.537 25.144 104.305 25.144 105.148ZM23.56 105.148C23.56 104.679 23.448 104.241 23.224 103.836C23 103.42 22.664 103.084 22.216 102.828C21.768 102.572 21.224 102.444 20.584 102.444C19.944 102.444 19.4053 102.567 18.968 102.812C18.52 103.057 18.184 103.383 17.96 103.788C17.736 104.193 17.624 104.631 17.624 105.1C17.624 105.569 17.736 106.007 17.96 106.412C18.184 106.807 18.52 107.121 18.968 107.356C19.4053 107.591 19.944 107.708 20.584 107.708C21.5333 107.708 22.2693 107.468 22.792 106.988C23.304 106.497 23.56 105.884 23.56 105.148ZM16.04 87.3467C16.04 86.6534 16.184 86.0347 16.472 85.4907C16.76 84.9361 17.1867 84.5041 17.752 84.1947C18.3173 83.8747 19 83.7147 19.8 83.7147L25 83.7147L25 85.5227L20.072 85.5227C19.2827 85.5227 18.68 85.7201 18.264 86.1147C17.8373 86.5094 17.624 87.0481 17.624 87.7307C17.624 88.4134 17.8373 88.9574 18.264 89.3627C18.68 89.7574 19.2827 89.9547 20.072 89.9547L25 89.9547L25 91.7627L20.072 91.7627C19.2827 91.7627 18.68 91.9601 18.264 92.3547C17.8373 92.7494 17.624 93.2881 17.624 93.9707C17.624 94.6534 17.8373 95.1974 18.264 95.6027C18.68 95.9974 19.2827 96.1947 20.072 96.1947L25 96.1947L25 98.0187L16.184 98.0187L16.184 96.1947L17.192 96.1947C16.8293 95.8961 16.5467 95.5174 16.344 95.0587C16.1413 94.6001 16.04 94.1094 16.04 93.5867C16.04 92.8827 16.1893 92.2534 16.488 91.6987C16.7867 91.1441 17.2187 90.7174 17.784 90.4187C17.2507 90.1521 16.8293 89.7361 16.52 89.1707C16.2 88.6054 16.04 87.9974 16.04 87.3467ZM17.48 78.8197C17.0747 78.5104 16.7333 78.0891 16.456 77.5557C16.1787 77.0224 16.04 76.4197 16.04 75.7477C16.04 74.9797 16.232 74.2811 16.616 73.6517C16.9893 73.0117 17.5173 72.5104 18.2 72.1477C18.8827 71.7851 19.6667 71.6037 20.552 71.6037C21.4373 71.6037 22.232 71.7851 22.936 72.1477C23.6293 72.5104 24.1733 73.0117 24.568 73.6517C24.952 74.2811 25.144 74.9797 25.144 75.7477C25.144 76.4197 25.0107 77.0171 24.744 77.5397C24.4667 78.0624 24.1253 78.4891 23.72 78.8197L29.192 78.8197L29.192 80.6437L16.184 80.6437L16.184 78.8197L17.48 78.8197ZM20.552 73.4597C19.944 73.4597 19.4213 73.5877 18.984 73.8437C18.536 74.0891 18.2 74.4197 17.976 74.8357C17.7413 75.2411 17.624 75.6784 17.624 76.1477C17.624 76.6064 17.7413 77.0437 17.976 77.4597C18.2107 77.8651 18.552 78.1957 19 78.4517C19.448 78.6971 19.976 78.8197 20.584 78.8197C21.192 78.8197 21.7253 78.6971 22.184 78.4517C22.632 78.1957 22.9733 77.8651 23.208 77.4597C23.4427 77.0437 23.56 76.6064 23.56 76.1477C23.56 75.6784 23.4427 75.2411 23.208 74.8357C22.9627 74.4197 22.6107 74.0891 22.152 73.8437C21.6933 73.5877 21.16 73.4597 20.552 73.4597ZM15.016 68.122C15.016 68.4527 14.904 68.73 14.68 68.954C14.456 69.178 14.1787 69.29 13.848 69.29C13.5173 69.29 13.24 69.178 13.016 68.954C12.792 68.73 12.68 68.4527 12.68 68.122C12.68 67.802 12.792 67.53 13.016 67.306C13.24 67.082 13.5173 66.97 13.848 66.97C14.1787 66.97 14.456 67.082 14.68 67.306C14.904 67.53 15.016 67.802 15.016 68.122ZM16.184 67.226L25 67.226L25 69.05L16.184 69.05L16.184 67.226ZM13.16 62.2572L25 62.2572L25 64.0812L13.16 64.0812L13.16 62.2572ZM20.552 59.7205C19.6667 59.7205 18.8827 59.5392 18.2 59.1765C17.5173 58.8032 16.9893 58.3018 16.616 57.6725C16.232 57.0325 16.04 56.3285 16.04 55.5605C16.04 54.8672 16.1787 54.2645 16.456 53.7525C16.7227 53.2298 17.0587 52.8138 17.464 52.5045L16.184 52.5045L16.184 50.6645L25 50.6645L25 52.5045L23.688 52.5045C24.104 52.8138 24.4507 53.2352 24.728 53.7685C25.0053 54.3018 25.144 54.9098 25.144 55.5925C25.144 56.3498 24.952 57.0432 24.568 57.6725C24.1733 58.3018 23.6293 58.8032 22.936 59.1765C22.232 59.5392 21.4373 59.7205 20.552 59.7205ZM20.584 52.5045C19.976 52.5045 19.448 52.6325 19 52.8885C18.552 53.1338 18.2107 53.4592 17.976 53.8645C17.7413 54.2698 17.624 54.7072 17.624 55.1765C17.624 55.6458 17.7413 56.0832 17.976 56.4885C18.2 56.8938 18.536 57.2245 18.984 57.4805C19.4213 57.7258 19.944 57.8485 20.552 57.8485C21.16 57.8485 21.6933 57.7258 22.152 57.4805C22.6107 57.2245 22.9627 56.8938 23.208 56.4885C23.4427 56.0725 23.56 55.6352 23.56 55.1765C23.56 54.7072 23.4427 54.2698 23.208 53.8645C22.9733 53.4592 22.632 53.1338 22.184 52.8885C21.7253 52.6325 21.192 52.5045 20.584 52.5045ZM17.464 45.6947C17.016 45.4281 16.6693 45.0761 16.424 44.6387C16.168 44.1907 16.04 43.6627 16.04 43.0547L17.928 43.0547L17.928 43.5187C17.928 44.2334 18.1093 44.7774 18.472 45.1507C18.8347 45.5134 19.464 45.6947 20.36 45.6947L25 45.6947L25 47.5187L16.184 47.5187L16.184 45.6947L17.464 45.6947Z"
            fill="white"
          />
          <path
            d="M14.2348 26C13.3515 26.1405 12.5994 26.1249 12 26H14.2348C19.2458 25.2031 28.4784 19.3833 38 0V26H14.2348Z"
            fill="#5ABB8D"
          />
          <path
            d="M14.2348 157.1C13.3515 156.959 12.5994 156.975 12 157.1H14.2348C19.2458 157.897 28.4784 163.716 38 183.1V157.1H14.2348Z"
            fill="#5ABB8D"
          />
        </svg>
      </button>
    </div>
  );
}
